{% extends "../layout/base.html" %}

{% block content %}
<div class="container my-3">
    <h1 class="display-6 border-bottom py-2">#{{ question.id }} {{ question.subject }}</h1>
    <div class="card mt-3">
        <div class="card-body">
            <div class="card-text" style="white-space: pre-line;">{{ question.content }}</div>
            <div class="d-flex justify-content-end">
                <div class="badge bg-light text-dark p-2">{{ question.created_at }}</div>
            </div>
        </div>
    </div>
    <div class="my-3">
        <a class="link-primary" href="{% url 'qna:index' %}">목록보기</a>
    </div>
</div>

<!-- 답변 목록 시작 -->
<h5 class="border-bottom my-3 py-2">{{ question.answer_set.count }}개의 답변이 있습니다.</h5>
{% for answer in question.answer_set.all %}
<div id="answer_{{ answer.id }}" class="card my-3">
    <div class="card-body">
        <div class="card-text" style="white-space: pre-line;">{{ answer.content }}</div>
        <div class="d-flex justify-content-end">
            <div class="badge bg-light text-dark p-2 text-start">{{ answer.created_at }}</div>
        </div>
        <form 
            action="{% url 'qna:answer_delete' answer_id=answer.id %}?question_id={{ question.id }}" 
            method="post" 
            class="d-flex mx-1"
            onsubmit="return confirm('정말 삭제하시겠습니까?')">
            {% csrf_token %}
            <button type="submit" class="badge rounded bg-danger border-0 text-light">삭제</button>
        </form>
    </div>
</div>
{% endfor %}
<!-- 답변 목록 끝 -->

<!-- 답변 등록 시작 -->
<form 
    action="{% url 'qna:answer_create' question_id=question.id %}" 
    method="post" class="my-3">
    {% csrf_token %}
    <div class="mb-3">
        <label for="content" class="form-label">답변내용</label>
        <textarea name="content" id="content" class="form-control" rows="10" required></textarea>
    </div>
    <input type="submit" value="답변등록" class="btn btn-primary">
</form>
<!-- 답변 등록 끝 -->

{% endblock %}

{% block script %}
<script>
console.log('question_detail.html');
</script>
{% endblock %}